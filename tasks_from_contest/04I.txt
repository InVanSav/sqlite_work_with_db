SELECT CONTESTS.ROWI AS CONTEST_ID,
TEAMS.KIND AS DISCIPLINE,
DENSE_RANK()
	OVER (PARTITION BY CONTESTS.ROWI, TEAMS.KIND ORDER BY POINTS.MARK DESC) AS POSITION,
TEAMS.ROWI AS TEAM_ID
FROM CONTESTS
JOIN TEAMS, POINTS
ON POINTS.TEAM = TEAMS.ROWI
AND POINTS.CONTEST = CONTESTS.ROWI 
ORDER BY CONTEST_ID, DISCIPLINE, POSITION, TEAM_ID;